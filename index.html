<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba ChatWidget</title>
    <link rel="stylesheet" href="chat-widget.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            color: #000;
        }
        
        .container {
            display: flex;
            flex: 1;
            gap: 20px;
        }
        
        .config-panel {
            width: 300px;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-y: auto;
            height: calc(100vh - 40px);
            position: sticky;
            top: 20px;
        }
        
        .config-group {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }
        
        .config-group h3 {
            margin-top: 0;
            color: #000;
        }
        
        label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
            font-size: 14px;
        }
        
        input[type="text"],
        input[type="color"],
        input[type="number"],
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        
        .preview-area {
            flex: 1;
            display: flex;
            position: relative;
            justify-content: center;
            align-items: center;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        #applyConfig{
            background: var(--primary-color); 
            border: 1px solid var(--primary-color);
            color: var(--text-left-bubble);
        }
        #applyConfig, #resetConfig{
            
            margin: 15px 0px;
            padding: 7px;
            width: 100%;
             
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        #applyConfig:hover, #resetConfig:hover{
            opacity: 0.8;
        }
        #resetConfig{
           background: #454547; 
           border: 1px solid #141218; 
           color: #fff;  
        }
        
    </style>
</head>
<body>

    
    <div class="container">
        <div class="config-panel">
            <h2>Configuración</h2>
            
            <div class="config-group">
                <label for="position">Posición del chat:</label>
                <select id="position">
                    <option value="right-top">Derecha - Superior</option>
                    <option value="center-top">Centro - Superior</option>
                    <option value="left-top">Izquierda - Superior</option>
                    <option value="right-bottom" selected>Derecha - Inferior</option>
                    <option value="center-bottom">Centro - Inferior</option>
                    <option value="left-bottom">Izquierda - Inferior</option>
                </select>
            </div>
            
            <div class="config-group">
                <label for="theme">Tema predefinido:</label>
                <select id="theme">
                    <option value="default" selected>Default</option>
                    <option value="pink">Rosa</option>
                    <option value="dark">Oscuro</option>
                    <option value="light">Claro</option>
                    <option value="purple">Morado</option>
                    <option value="blue">Azul</option>
                    <option value="custom">Personalizado</option>
                </select>
                
                <div id="container-custom" class="hidden">
                    <h4>Colores personalizados</h4>
                    <label for="primaryColor">Color principal:</label>
                    <input type="color" id="primaryColor" value="#7b3fe4">
                    
                    <label for="bgColor">Color de fondo:</label>
                    <input type="color" id="bgColor" value="#ffffff">
                    
                    <label for="textColor">Color de texto:</label>
                    <input type="color" id="textColor" value="#000000">
                    
                    <label for="textLeftBubble">Texto burbuja izquierda:</label>
                    <input type="color" id="textLeftBubble" value="#ffffff">
                    
                    <label for="textRightBubble">Texto burbuja derecha:</label>
                    <input type="color" id="textRightBubble" value="#000000">
                    
                    <label for="bgRightBubble">Fondo burbuja derecha:</label>
                    <input type="color" id="bgRightBubble" value="#e5e5ea">
                </div>
            </div>
            
            <div class="config-group">
                <label for="companyName">Nombre de la empresa:</label>
                <input type="text" id="companyName" value="Soporte">
                
                <label for="logoUrl">URL del logo:</label>
                <input type="text" id="logoUrl" value="/bot.png">
            </div>
            
            <div class="config-group">
                <label class="hidden" for="welcomeMessage">Mensaje de bienvenida:</label>
                <input type="hidden" id="welcomeMessage" value="Hola, ¿en qué te podemos ayudar?">
                
                <label for="responseMessage">Mensaje de respuesta:</label>
                <input type="text" id="responseMessage" value="Gracias por tu mensaje. ¿En qué más podemos ayudarte?">
                
                <label class="hidden" for="onlineText">Texto de estado:</label>
                <input type="hidden" id="onlineText" value="En línea">
                
                <label for="tooltipText">Texto del tooltip:</label>
                <input type="text" id="tooltipText" value="Hola, ¿en qué te podemos ayudar?">
            </div>
            
            <div class="config-group">
                <label for="tooltipDelay">Retardo del tooltip (ms):</label>
                <input type="number" id="tooltipDelay" value="3000">
                
               
            </div>
            
            <button id="applyConfig">Aplicar Configuración</button>
            <button id="resetConfig">Restablecer Valores</button>
        </div>
        
        <div class="preview-area">
            <p>El ChatWidget aparecerá según la posición configurada. Usa los controles para probar diferentes configuraciones.</p>
        </div>
    </div>

    <script src="chat-widget.js"></script>
    <script>
        // Instancia del ChatWidget
        let chatWidget;
        const containerCustom = document.getElementById('container-custom');
        // Función para aplicar la configuración
        // En el método applyConfiguration de widget.html
        function applyConfiguration() {
            const config = {
                position: document.getElementById('position').value,
                theme: document.getElementById('theme').value,
                primaryColor: document.getElementById('primaryColor').value,
                bgColor: document.getElementById('bgColor').value,
                textColor: document.getElementById('textColor').value,
                textLeftBubble: document.getElementById('textLeftBubble').value,
                textRightBubble: document.getElementById('textRightBubble').value,
                bgRightBubble: document.getElementById('bgRightBubble').value,
                companyName: document.getElementById('companyName').value,
                logoUrl: document.getElementById('logoUrl').value,
                welcomeMessage: document.getElementById('responseMessage').value,
                responseMessage: document.getElementById('responseMessage').value,
                onlineText: document.getElementById('onlineText').value,
                tooltipText: document.getElementById('tooltipText').value,
                tooltipDelay: parseInt(document.getElementById('tooltipDelay').value),
                //autoResponseDelay: parseInt(document.getElementById('autoResponseDelay').value),
                onMessageSent: function(message) {
                    console.log('Mensaje enviado:', message);
                },
                onFileUpload: function(file) {
                    console.log('Archivo subido:', file.name);
                }
            };
            
            // Si ya existe una instancia, destruirla
            if (chatWidget) {
                document.querySelectorAll('#chat-launcher, #chatWrapper').forEach(el => el.remove());
            }
            
            // Crear nueva instancia
            chatWidget = new ChatWidget(config);
            
            // Si el tema es personalizado, aplicar los colores personalizados
            if (config.theme === 'custom') {
                chatWidget.setColors({
                    primaryColor: config.primaryColor,
                    bgColor: config.bgColor,
                    textColor: config.textColor,
                    textLeftBubble: config.textLeftBubble,
                    textRightBubble: config.textRightBubble,
                    bgRightBubble: config.bgRightBubble
                });
            }
        }
        
        function resetConfiguration() {
            document.getElementById('position').value = 'right-bottom';
            document.getElementById('theme').value = 'default';
            document.getElementById('primaryColor').value = '#7b3fe4';
            document.getElementById('bgColor').value = '#ffffff';
            document.getElementById('textColor').value = '#000000';
            document.getElementById('textLeftBubble').value = '#ffffff';
            document.getElementById('textRightBubble').value = '#000000';
            document.getElementById('bgRightBubble').value = '#e5e5ea';
            document.getElementById('companyName').value = 'Soporte';
            document.getElementById('logoUrl').value = 'bot.png';
            document.getElementById('welcomeMessage').value = 'Hola, ¿en qué te podemos ayudar?';
            document.getElementById('responseMessage').value = 'Gracias por tu mensaje. ¿En qué más podemos ayudarte?';
            document.getElementById('onlineText').value = 'En línea';
            document.getElementById('tooltipText').value = 'Hola, ¿en qué te podemos ayudar?';
            document.getElementById('tooltipDelay').value = '3000';
            //document.getElementById('autoResponseDelay').value = '1000';
            
            document.getElementById('theme').dispatchEvent(new Event('change'));
            
            applyConfiguration();
        }
        
        document.getElementById('applyConfig').addEventListener('click', applyConfiguration);
        document.getElementById('resetConfig').addEventListener('click', resetConfiguration);
        
        document.getElementById('theme').addEventListener('change', function() {
            const colorControls = document.querySelectorAll('input[type="color"]');
            const isCustom = this.value === 'custom';
            if(isCustom){
                containerCustom.classList.remove('hidden');
            }else{
                containerCustom.classList.add('hidden');
            }
            colorControls.forEach(control => {
                control.closest('label').style.display = isCustom ? 'block' : 'none';
            });
        
            // Mostrar el título "Colores personalizados" solo cuando sea necesario
            document.querySelector('.config-group h4').style.display = isCustom ? 'block' : 'none';
        });

        window.addEventListener('DOMContentLoaded', () => {
            resetConfiguration();
            // Disparar el evento change para inicializar correctamente la visibilidad
            document.getElementById('theme').dispatchEvent(new Event('change'));
        });
    </script>
</body>
</html>
